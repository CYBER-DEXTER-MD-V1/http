<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>YouTube Video Looper</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">
  <header class="bg-red-600 text-white text-2xl text-center p-4 font-bold">
    üé• YouTube Video 100x Loop Player
  </header>

  <main class="max-w-xl mx-auto mt-8 bg-white p-6 rounded-xl shadow">
    <label class="block mb-2 font-semibold">Paste a YouTube Video Link:</label>
    <input type="text" id="videoUrl" placeholder="https://www.youtube.com/watch?v=VIDEO_ID"
           class="w-full p-2 border rounded mb-4" />

    <button onclick="startLoop()" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">
      ‚ñ∂Ô∏è Start Looping
    </button>

    <div id="status" class="mt-4 text-center text-lg font-bold hidden">
      Playing... <span id="counter">0</span> / 100
    </div>

    <div class="mt-6 aspect-video hidden" id="videoWrapper">
      <iframe id="ytPlayer" class="w-full h-full rounded" frameborder="0"
              allow="autoplay; encrypted-media" allowfullscreen></iframe>
    </div>
  </main>

  <script>
    let playCount = 0;
    const maxPlays = 100;
    let player;

    function extractVideoId(url) {
      const regex = /(?:youtu\.be\/|youtube\.com\/(?:watch\?v=|embed\/|shorts\/|v\/|.*[?&]v=))([^"&?\/\s]{11})/;
      const match = url.match(regex);
      return match ? match[1] : null;
    }

    function startLoop() {
      const inputUrl = document.getElementById("videoUrl").value.trim();
      const videoId = extractVideoId(inputUrl);
      if (!videoId) {
        alert("Invalid YouTube URL!");
        return;
      }

      document.getElementById("status").classList.remove("hidden");
      document.getElementById("videoWrapper").classList.remove("hidden");

      loadPlayer(videoId);
    }

    function loadPlayer(videoId) {
      const iframe = document.getElementById("ytPlayer");
      iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&enablejsapi=1&rel=0&playsinline=1&mute=0&loop=0`;

      // Inject YouTube Player API
      if (!window.YT) {
        const tag = document.createElement("script");
        tag.src = "https://www.youtube.com/iframe_api";
        document.body.appendChild(tag);
        window.onYouTubeIframeAPIReady = () => createYTPlayer(videoId);
      } else {
        createYTPlayer(videoId);
      }
    }

    function createYTPlayer(videoId) {
      player = new YT.Player("ytPlayer", {
        videoId: videoId,
        events: {
          'onStateChange': onPlayerStateChange
        }
      });
    }

    function onPlayerStateChange(event) {
      // When video ends
      if (event.data === YT.PlayerState.ENDED) {
        playCount++;
        document.getElementById("counter").innerText = playCount;

        if (playCount < maxPlays) {
          player.seekTo(0);
          player.playVideo();
        } else {
          alert("‚úÖ Finished playing 100 times!");
        }
      }
    }
  </script>
</body>
</html>
