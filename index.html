<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>YouTube Channel Viewer</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 text-gray-800">

  <header class="bg-red-600 text-white p-4 text-center text-2xl font-bold shadow">
    üî¥ YouTube Channel Viewer
  </header>

  <section class="max-w-xl mx-auto mt-6 p-4 bg-white rounded-xl shadow">
    <label class="block mb-2 text-sm font-medium">Paste Your YouTube Channel URL:</label>
    <input id="channelUrl" type="text" placeholder="https://www.youtube.com/@YourChannelName" class="w-full p-2 border rounded mb-4" />
    <button onclick="handleFetch()" class="bg-red-600 text-white px-4 py-2 rounded hover:bg-red-700">Fetch Videos</button>
    <p id="error" class="text-sm text-red-600 mt-2 hidden">Error: Invalid channel URL or failed to fetch.</p>
  </section>

  <main id="video-container" class="p-6 max-w-6xl mx-auto grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
    <!-- Videos will appear here -->
  </main>

  <footer class="text-center text-sm text-gray-500 py-6">
    ¬© 2025 CYBER DEXTER | Made with ‚ù§Ô∏è + YouTube API
  </footer>

  <script>
    const API_KEY = "AIzaSyCMaxHj34zs_wdIEJPXX6hwR0Q2_RDCxCw"; // Replace with your real key
    const MAX_RESULTS = 6;
    const errorEl = document.getElementById("error");
    const container = document.getElementById("video-container");

    async function getChannelIdFromUrl(url) {
      try {
        if (url.includes("/channel/")) {
          // Direct channel ID link
          return url.split("/channel/")[1].split(/[/?#]/)[0];
        } else if (url.includes("/@")) {
          // Handle @username channels (need to resolve it to ID)
          const username = url.split("/@")[1].split(/[/?#]/)[0];
          const res = await fetch(`https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&q=${username}&type=channel&part=snippet`);
          const data = await res.json();
          return data.items[0]?.snippet?.channelId || null;
        } else {
          return null;
        }
      } catch (err) {
        console.error("Channel ID fetch error", err);
        return null;
      }
    }

    async function fetchVideos(channelId) {
      container.innerHTML = "";
      errorEl.classList.add("hidden");

      const apiURL = `https://www.googleapis.com/youtube/v3/search?key=${API_KEY}&channelId=${channelId}&part=snippet,id&order=date&maxResults=${MAX_RESULTS}`;
      
      try {
        const res = await fetch(apiURL);
        const data = await res.json();

        if (!data.items || data.items.length === 0) throw new Error("No videos");

        data.items.forEach(item => {
          if (item.id.kind === "youtube#video") {
            const videoId = item.id.videoId;
            const title = item.snippet.title;
            const desc = item.snippet.description;
            const thumb = item.snippet.thumbnails.high.url;

            const card = `
              <div class="bg-white shadow-md rounded-xl overflow-hidden">
                <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank">
                  <img src="${thumb}" alt="${title}" class="w-full h-48 object-cover" />
                </a>
                <div class="p-4">
                  <h2 class="text-lg font-semibold">${title}</h2>
                  <p class="text-sm text-gray-600 mt-1">${desc.slice(0, 80)}...</p>
                </div>
              </div>
            `;
            container.innerHTML += card;
          }
        });

      } catch (err) {
        errorEl.classList.remove("hidden");
        console.error("Video fetch failed", err);
      }
    }

    async function handleFetch() {
      const url = document.getElementById("channelUrl").value.trim();
      const channelId = await getChannelIdFromUrl(url);
      if (channelId) {
        fetchVideos(channelId);
      } else {
        errorEl.classList.remove("hidden");
      }
    }
  </script>

</body>
</html>
